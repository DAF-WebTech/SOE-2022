{"version":3,"sources":["../../../src/biodiversity/terrestrial-ecosystems/extent-change-remnant.js"],"sourcesContent":["\"use strict\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n\r\n\tconst years = soefinding.findingJson.meta.fields.slice(4);\r\n\tconst latestYear = years.at(-1)\r\n\r\n\t// sort data by latest year\r\n\tsoefinding.findingJson.data.sort(function (a, b) {\r\n\t\treturn b[latestYear] - a[latestYear]\r\n\t})\r\n\r\n\tconst bioregions = {}\r\n\tconst qldData = [] // we need to populate a qld item as we go\r\n\tsoefinding.findingJson.data.forEach(d => {\r\n\t\t// fix up the group label\r\n\t\td[\"Broad vegetation group label\"] = `${d[\"Broad vegetation group number\"]}. ${d[\"Broad vegetation group label\"].replace(\"-\", \"—\")}` //mdash\r\n\r\n\t\t// group by bioregion\r\n\t\tif (!bioregions[d.Bioregion]) {\r\n\t\t\tbioregions[d.Bioregion] = []\r\n\t\t}\r\n\t\tbioregions[d.Bioregion].push(d)\r\n\r\n\t\tlet qldGroup = qldData.find(q => q[\"Broad vegetation group label\"] == d[\"Broad vegetation group label\"])\r\n\t\tif (!qldGroup) {\r\n\t\t\tqldGroup = {\r\n\t\t\t\t\"Broad vegetation group label\": d[\"Broad vegetation group label\"],\r\n\t\t\t\t[latestYear]: 0\r\n\t\t\t}\r\n\t\t\tqldData.push(qldGroup)\r\n\t\t}\r\n\t\tqldGroup[latestYear] += d[latestYear]\r\n\t})\r\n\r\n\t// set our chart data for each region\r\n\tfor (const bioregion in bioregions) {\r\n\t\tsoefinding.findingContent[bioregion] = {\r\n\t\t\tseries1: bioregions[bioregion].map(d => {\r\n\t\t\t\t// as a side effect populate qld value\r\n\t\t\t\treturn d[latestYear]\r\n\t\t\t}),\r\n\t\t\tlabels1: bioregions[bioregion].map(d => d[\"Broad vegetation group label\"])\r\n\t\t}\r\n\t}\r\n\t// set chart date for qld, but first needs sorting\r\n\tqldData.sort(function (a, b) {\r\n\t\treturn b[latestYear] - a[latestYear]\r\n\t})\r\n\tsoefinding.findingContent.Queensland = {\r\n\t\tseries1: qldData.map(d => d[latestYear]),\r\n\t\tlabels1: qldData.map(d => d[\"Broad vegetation group label\"]) // or could be keys of bioregions\r\n\t}\r\n\r\n\tconst options1 = soefinding.getDefaultPieChartOptions()\r\n\toptions1.chart.id = \"chart1\"\r\n\toptions1.labels = soefinding.findingContent[soefinding.state.currentRegionName].labels1\r\n\toptions1.tooltip = {\r\n\t\ty: {\r\n\t\t\tformatter: (val, options) => {\r\n\t\t\t\tconst percent = options.globals.seriesPercent[options.seriesIndex][0]\r\n\t\t\t\treturn `${val.toLocaleString()} ha. (${percent.toFixed(1)}%)`\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\toptions1.xaxis.categories = [\"Broad vegetation group\", \"Hectares\"] // these are the table headings\r\n\r\n\r\n\tsoefinding.state.chart1 = {\r\n\t\toptions: options1,\r\n\t\tseries: soefinding.findingContent[soefinding.state.currentRegionName].series1,\r\n\t\tchartactive: true,\r\n\t}\r\n\r\n\r\n\t// chart 2, column chart for each region, not displayed for qld\r\n\tconst seriesNames = [\"Pre-clear vegetation\", latestYear]\r\n\tfor (const bioregion in bioregions) {\r\n\t\tbioregions[bioregion].sort(function (a, b) {\r\n\t\t\treturn a[\"Broad vegetation group number\"] - b[\"Broad vegetation group number\"]\r\n\t\t})\r\n\t\tsoefinding.findingContent[bioregion].series2 = seriesNames.map(s => {\r\n\t\t\treturn {\r\n\t\t\t\tname: s,\r\n\t\t\t\tdata: bioregions[bioregion].map(d => d[s])\r\n\t\t\t}\r\n\t\t})\r\n\t\tsoefinding.findingContent[bioregion].labels2 = bioregions[bioregion].map(d => d[\"Broad vegetation group label\"])\r\n\t}\r\n\tsoefinding.findingContent.Queensland.series2 = soefinding.findingContent[\"Wet Tropics\"].series2 // won't be seen but needs a default\r\n\tsoefinding.findingContent.Queensland.labels2 = soefinding.findingContent[\"Wet Tropics\"].labels2 // won't be seen but needs a default\r\n\r\n\tconst options2 = soefinding.getDefaultColumnChartOptions()\r\n\toptions2.chart.id = \"chart2\"\r\n\toptions2.tooltip.y = { formatter: val => `${val.toLocaleString()}ha` }\r\n\toptions2.xaxis.categories = soefinding.findingContent[soefinding.state.currentRegionName].labels2\r\n\toptions2.xaxis.labels.trim = true,\r\n\t\toptions2.xaxis.labels.hideOverlappingLabels = false\r\n\r\n\r\n\toptions2.xaxis.tickPlacement = \"between\" // not a good option, but it fixes a bug\r\n\t// where the chart xaxis did not redraw correctly when a) swapping between regions. and then b) clicking one of the legends\r\n\toptions2.xaxis.title.text = \"Broad Vegetation Group\"\r\n\toptions2.yaxis.labels.formatter = val => `${val / 1000000}M`\r\n\toptions2.yaxis.title.text = \"Hectares\"\r\n\r\n\tsoefinding.state.chart2 = {\r\n\t\toptions: options2,\r\n\t\tseries: soefinding.findingContent[soefinding.state.currentRegionName].series2,\r\n\t\tchartactive: true,\r\n\t}\r\n\r\n\t// third chart, stacked column for each region and qld\r\n\tconst data3 = JSON.parse(document.getElementById(\"jsonData3\").textContent) // data for chart 3\r\n\tconst keys = data3.meta.fields.slice(3)\r\n\tconst lastKey = keys.at(-1)\r\n\r\n\tconst qldItem3 = {}\r\n\tfor (let bioregion in bioregions) { // assume same bioregions as what we had in data file 1\r\n\t\tconst regionData = data3.data.filter(d => d.Bioregion == bioregion)\r\n\t\tsoefinding.findingContent[bioregion].series3 = regionData.map(d => {\r\n\t\t\t// as a side effect, populate the qld item\r\n\t\t\tconst name = `${d[\"Broad vegetation group number\"]}. ${d[\"Broad vegetation group label\"]}`\r\n\t\t\tif (!qldItem3[name])\r\n\t\t\t\tqldItem3[name] = keys.map(k => 0)\r\n\t\t\tqldItem3[name].forEach((q, i) => qldItem3[name][i] += d[keys[i]])\r\n\r\n\t\t\treturn {\r\n\t\t\t\tname,\r\n\t\t\t\tdata: keys.map(k => d[k])\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tsoefinding.findingContent.Queensland.series3 = Object.keys(qldItem3).map(q => {\r\n\t\treturn {\r\n\t\t\tname: q.replace(\"-\", \"—\"), //emdash\r\n\t\t\tdata: qldItem3[q]\r\n\t\t}\r\n\t})\r\n\tsoefinding.findingContent.Queensland.series3.sort(function (a, b) {\r\n\t\treturn parseInt(a.name.substring(0, a.name.indexOf(\".\"))) - parseInt(b.name.substring(0, b.name.indexOf(\".\")))\r\n\t})\r\n\r\n\tconst options3 = soefinding.getDefaultStackedColumnChartOptions()\r\n\toptions3.chart.height = 600\r\n\toptions3.chart.id = \"chart3\"\r\n\toptions3.legend.inverseOrder = false\r\n\toptions3.legend.offsetY = 20\r\n\toptions3.legend.position = \"bottom\"\r\n\toptions3.tooltip.y = { formatter: val => val.toLocaleString() }\r\n\toptions3.xaxis.categories = keys.map(k => [k.substring(0, k.indexOf(\"-\")) + \"–\", k.substring(k.indexOf(\"-\") + 1)])  //endash\r\n\tdelete options3.xaxis.tickPlacement\r\n\toptions3.xaxis.title.text = \"Year\"\r\n\toptions3.yaxis.labels.formatter = val => val >= 1000000 ? `${val / 1000000}M` : `${val / 1000}k`\r\n\toptions3.yaxis.labels.minWidth = 30\r\n\toptions3.yaxis.title.text = \"Hectares lost\"\r\n\toptions3.tooltip.shared = false\r\n\r\n\r\n\r\n\tsoefinding.state.chart3 = {\r\n\t\toptions: options3,\r\n\t\tseries: soefinding.findingContent[soefinding.state.currentRegionName].series3,\r\n\t\tchartactive: true,\r\n\t}\r\n\r\n\r\n\tnew Vue({\r\n\t\tel: \"#chartContainer\",\r\n\t\tdata: soefinding.state,\r\n\t\tcomputed: {\r\n\t\t\theading1: () => `Proportion of broad vegetation groups in ${soefinding.state.currentRegionName}, ${latestYear}`,\r\n\t\t\theading2: () => `Pre-clear and ${latestYear} extents of broad vegetation groups in ${soefinding.state.currentRegionName}`,\r\n\t\t\theading3: function () {\r\n\t\t\t\tlet retVal = \"Change in extent of broad vegetation groups\"\r\n\t\t\t\tif (this.currentRegionName != \"Queensland\")\r\n\t\t\t\t\tretVal += ` in ${this.currentRegionName}`\r\n\t\t\t\treturn retVal\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tformatter1: val => val.toLocaleString(),\r\n\t\t\tonStackedRadioClick: function () {\r\n\t\t\t\tthis.chart3.options.chart.type = \"bar\"\r\n\t\t\t\tthis.chart3.options.chart.stacked = true\r\n\t\t\t},\r\n\t\t\tonLineRadioClick: function () {\r\n\t\t\t\tthis.chart3.options.chart.type = \"line\"\r\n\t\t\t\tthis.chart3.options.chart.stacked = false\r\n\t\t\t\tthis.chart3.options.markers = { size: 4 } // ignored by column chart\r\n\t\t\t\tthis.chart3.options.tooltip.shared = false\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\r\n\twindow.soefinding.onRegionChange = function () {\r\n\t\t// set the data series in each of the vue apps, for the current region\r\n\r\n\t\t// chart 1\r\n\t\tsoefinding.state.chart1.series = this.findingContent[this.state.currentRegionName].series1\r\n\t\t// this works on the table\r\n\t\tsoefinding.state.chart1.options.labels = this.findingContent[this.state.currentRegionName].labels1\r\n\t\t// but we also need this for the chart to update\r\n\t\tApexCharts.exec(\"chart1\", \"updateOptions\", {\r\n\t\t\tlabels: this.findingContent[this.state.currentRegionName].labels1,\r\n\t\t})\r\n\r\n\t\t// chart 2\r\n\t\tif (this.state.currentRegionName != \"Queensland\") {\r\n\t\t\tsoefinding.state.chart2.series = this.findingContent[this.state.currentRegionName].series2\r\n\t\t\t// this works on the table\r\n\t\t\tsoefinding.state.chart2.options.xaxis.categories = this.findingContent[this.state.currentRegionName].labels2\r\n\t\t\t// but we also need this for the chart to update\r\n\t\t\tApexCharts.exec(\"chart2\", \"updateOptions\", {\r\n\t\t\t\txaxis: { categories: this.findingContent[this.state.currentRegionName].labels2 }\r\n\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\t// chart 3\r\n\t\tsoefinding.state.chart3.series = this.findingContent[this.state.currentRegionName].series3\r\n\t\t// \t\t// this works on the table\r\n\t\t// \t\tsoefinding.state.chart3.options.xaxis.categories = this.findingContent[this.state.currentRegionName].labels3\r\n\t\t// \t\t// but we also need this for the chart to update\r\n\t\t// \t\tApexCharts.exec(\"chart3\", \"updateOptions\", {\r\n\t\t// \t\t\txaxis: {categories: this.findingContent[this.state.currentRegionName].labels3}}\r\n\t\t// \t\t)\r\n\r\n\r\n\t\tsoefinding.loadFindingHtml();\r\n\t}\r\n\r\n\r\n})"],"mappings":"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","names":[]}
{"version":3,"sources":["../../../src/climate/climate-observations/evaporation-rate.js"],"sourcesContent":["\"use strict\"\n\nsoefinding.regions = pinLocations // these should already be set in ssjs\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n\n\tsoefinding.yearKeys = soefinding.findingJson.meta.fields.slice(2)\n\tconst latestYear = soefinding.yearKeys[soefinding.yearKeys.length - 1]\n\tconst regionNames = Object.keys(soefinding.regions)\n\n\t//1. bar chart for queensland\n\t// now the queensland figures, which fit into column chart\n\t// we get the average of the \"Actual\" item\n\tconst locationItems = soefinding.findingJson.data.filter(d => d.Measure == \"Actual\")\n\tconst qldSeries = [{\n\t\tname: \"Average\",\n\t\tdata: locationItems.map(d => {\n\t\t\tlet count = 0\n\t\t\tconst sum = soefinding.yearKeys.reduce(function (acc, curr, i, a) {\n\t\t\t\tif (d[curr]) {\n\t\t\t\t\t++count\n\t\t\t\t\treturn acc + d[curr]\n\t\t\t\t} else return acc\n\t\t\t}, 0)\n\t\t\treturn sum / count\n\t\t})\n\t}]\n\tsoefinding.findingContent.Queensland = {\n\t\thtml: \"\",\n\t\tapp1: qldSeries\n\t}\n\n\n\tconst options1 = soefinding.getDefaultBarChartOptions()\n\toptions1.xaxis.categories = locationItems.map(d => d.Name)\n\toptions1.xaxis.title.text = \"Station\"\n\toptions1.yaxis.title.text = \"Mean annual pan evaporation (millimetres)\"\n \toptions1.yaxis.labels.formatter = val => Math.round(val).toLocaleString()\n\toptions1.tooltip.y = { formatter: val => val.toLocaleString() }\n\n\tsoefinding.state.chart1 = {\n\t\toptions: options1,\n\t\tseries: soefinding.findingContent.Queensland.app1,\n\t\tchartactive: true,\n\t}\n\n\n\t// 2. line chart for each region\n\n\tfor (let region in soefinding.regions) {\n\n\t\t// create a data series for this region\n\t\tconst item = soefinding.findingJson.data.filter(d => d.Name == region)\n\t\tconst seriesNames = [\"Actual\", \"Moving average\"]\n\t\tconst series = seriesNames.map(s => {\n\t\t\tconst regionItem = item.find(d => d.Measure == s)\n\t\t\treturn {\n\t\t\t\tname: s,\n\t\t\t\tdata: soefinding.yearKeys.map(y => regionItem[y])\n\t\t\t}\n\t\t})\n\n\t\t// findingContent holds the html and data series for each region\n\t\tsoefinding.findingContent[region] = {\n\t\t\thtml: \"\",\n\t\t\tapp2: series\n\t\t}\n\t}\n\n\n\tconst options2 = soefinding.getDefaultLineChartOptions()\n\toptions2.xaxis.categories = soefinding.yearKeys\n\toptions2.xaxis.title.text = \"Year\"\n\toptions2.yaxis.title.text = \"Annual pan evaporation (millimetres)\"\n\toptions2.yaxis.labels.formatter = val => Math.round(val).toLocaleString()\n\toptions2.tooltip.y = { formatter: val => val?.toLocaleString() ?? \"n/a\" }\n\n\n\tsoefinding.state.chart2 = {\n\t\toptions: options2,\n\t\tseries: null,\n\t\tchartactive: true,\n\t}\n\tif (soefinding.state.currentRegionName == \"Queensland\")\n\t  soefinding.state.chart2.series = soefinding.findingContent[\"Cairns Airport\"].app2 // need a default\n\telse\n      soefinding.state.chart2.series = soefinding.findingContent[soefinding.state.currentRegionName].app2\n\n\tnew Vue({\n\t\tel: \"#chartContainer\",\n\t\tdata: soefinding.state,\n\t\tcomputed: {\n\t\t\theading1: () => `Mean annual pan evaporation, ${soefinding.yearKeys[0]}â€“${latestYear}`,\n\t\t\theading2: () => `Trend in evaporation rate at ${soefinding.state.currentRegionName}`,\n\t\t},\n\t\tmethods: {\n\t\t\tformatter1: function (val) { return val?.toLocaleString(undefined, { minimumFractionDigits: 1, maximumFractionDigits: 1, }) ?? \"\" }\n\t\t}\n\t})\n\n\tif (soefinding.state.currentRegionName == \"Queensland\")\n\t\tsoefinding.onRegionChange()\n\n\n})\n\n\n\nsoefinding.onRegionChange = function () {\n\n\tconst regionInfos = document.querySelectorAll(\"div.region-info\")\n\n\tif (this.state.currentRegionName == \"Queensland\") {\n\t\t// toggle visibility of first region-info, which is for Queensland\n\t\ttry {\n\t\tregionInfos[0].style.display = \"block\"\n\t\tregionInfos[1].style.display = \"none\"\n\t\t} catch(e) {\n\t\t\t// i don't know why there's only one sometimes\n\t\t}\n\t}\n\telse {\n\t\t// toggle visibility of second region-info, which is for the current region\n\t\tregionInfos[0].style.display = \"none\"\n\t\tregionInfos[1].style.display = \"block\"\n\n\t\t// set the data series in each of the vue apps, for the current region\n\t\tthis.state.chart2.series = this.findingContent[this.state.currentRegionName].app2\n\t}\n\n\tsoefinding.loadFindingHtml();\n}\n\n"],"mappings":"aAEA,WAAW,QAAU,aAGrB,SAAS,iBAAiB,mBAAoB,UAAY,CAEzD,WAAW,SAAW,WAAW,YAAY,KAAK,OAAO,MAAM,GAC/D,GAAM,GAAa,WAAW,SAAS,WAAW,SAAS,OAAS,GAC9D,EAAc,OAAO,KAAK,WAAW,SAKrC,EAAgB,WAAW,YAAY,KAAK,OAAO,GAAK,EAAE,SAAW,UACrE,EAAY,CAAC,CAClB,KAAM,UACN,KAAM,EAAc,IAAI,GAAK,CAC5B,GAAI,GAAQ,EAOZ,MAAO,AANK,YAAW,SAAS,OAAO,SAAU,EAAK,EAAM,EAAG,EAAG,CACjE,MAAI,GAAE,GACL,GAAE,EACK,EAAM,EAAE,IACF,GACZ,GACU,MAGf,WAAW,eAAe,WAAa,CACtC,KAAM,GACN,KAAM,GAIP,GAAM,GAAW,WAAW,4BAC5B,EAAS,MAAM,WAAa,EAAc,IAAI,GAAK,EAAE,MACrD,EAAS,MAAM,MAAM,KAAO,UAC5B,EAAS,MAAM,MAAM,KAAO,4CAC3B,EAAS,MAAM,OAAO,UAAY,GAAO,KAAK,MAAM,GAAK,iBAC1D,EAAS,QAAQ,EAAI,CAAE,UAAW,GAAO,EAAI,kBAE7C,WAAW,MAAM,OAAS,CACzB,QAAS,EACT,OAAQ,WAAW,eAAe,WAAW,KAC7C,YAAa,IAMd,OAAS,KAAU,YAAW,QAAS,CAGtC,GAAM,GAAO,WAAW,YAAY,KAAK,OAAO,GAAK,EAAE,MAAQ,GAEzD,EAAS,AADK,CAAC,SAAU,kBACJ,IAAI,GAAK,CACnC,GAAM,GAAa,EAAK,KAAK,GAAK,EAAE,SAAW,GAC/C,MAAO,CACN,KAAM,EACN,KAAM,WAAW,SAAS,IAAI,GAAK,EAAW,OAKhD,WAAW,eAAe,GAAU,CACnC,KAAM,GACN,KAAM,GAKR,GAAM,GAAW,WAAW,6BAC5B,EAAS,MAAM,WAAa,WAAW,SACvC,EAAS,MAAM,MAAM,KAAO,OAC5B,EAAS,MAAM,MAAM,KAAO,uCAC5B,EAAS,MAAM,OAAO,UAAY,GAAO,KAAK,MAAM,GAAK,iBACzD,EAAS,QAAQ,EAAI,CAAE,UAAW,GAAI,CA5EvC,MA4E0C,0BAAK,mBAAL,OAAyB,QAGlE,WAAW,MAAM,OAAS,CACzB,QAAS,EACT,OAAQ,KACR,YAAa,IAEd,AAAI,WAAW,MAAM,mBAAqB,aACxC,WAAW,MAAM,OAAO,OAAS,WAAW,eAAe,kBAAkB,KAE1E,WAAW,MAAM,OAAO,OAAS,WAAW,eAAe,WAAW,MAAM,mBAAmB,KAEpG,GAAI,KAAI,CACP,GAAI,kBACJ,KAAM,WAAW,MACjB,SAAU,CACT,SAAU,IAAM,gCAAgC,WAAW,SAAS,WAAM,IAC1E,SAAU,IAAM,gCAAgC,WAAW,MAAM,qBAElE,QAAS,CACR,WAAY,SAAU,EAAK,CAjG9B,MAiGgC,MAAO,oBAAK,eAAe,OAAW,CAAE,sBAAuB,EAAG,sBAAuB,MAAlF,OAA2F,OAI7H,WAAW,MAAM,mBAAqB,cACzC,WAAW,mBAOb,WAAW,eAAiB,UAAY,CAEvC,GAAM,GAAc,SAAS,iBAAiB,mBAE9C,GAAI,KAAK,MAAM,mBAAqB,aAEnC,GAAI,CACJ,EAAY,GAAG,MAAM,QAAU,QAC/B,EAAY,GAAG,MAAM,QAAU,YAC7B,MAMF,GAAY,GAAG,MAAM,QAAU,OAC/B,EAAY,GAAG,MAAM,QAAU,QAG/B,KAAK,MAAM,OAAO,OAAS,KAAK,eAAe,KAAK,MAAM,mBAAmB,KAG9E,WAAW","names":[]}
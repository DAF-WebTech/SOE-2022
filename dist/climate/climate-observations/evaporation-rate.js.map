{"version":3,"sources":["../../../src/climate/climate-observations/evaporation-rate.js"],"sourcesContent":["\"use strict\"\n\nsoefinding.regions = pinLocations // these should already be set in ssjs\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n\n\tsoefinding.yearKeys = soefinding.findingJson.meta.fields.slice(2)\n\tconst latestYear = soefinding.yearKeys[soefinding.yearKeys.length - 1]\n\tconst regionNames = Object.keys(soefinding.regions)\n\n\t//1. bar chart for queensland\n\t// now the queensland figures, which fit into column chart\n\t// we get the average of the \"Actual\" item\n\tconst locationItems = soefinding.findingJson.data.filter(d => d.Measure == \"Actual\")\n\tconst qldSeries = [{\n\t\tname: \"Average\",\n\t\tdata: locationItems.map(d => {\n\t\t\tlet count = 0\n\t\t\tconst sum = soefinding.yearKeys.reduce(function (acc, curr, i, a) {\n\t\t\t\tif (d[curr]) {\n\t\t\t\t\t++count\n\t\t\t\t\treturn acc + d[curr]\n\t\t\t\t} else return acc\n\t\t\t}, 0)\n\t\t\treturn sum / count\n\t\t})\n\t}]\n\tsoefinding.findingContent.Queensland = {\n\t\thtml: \"\",\n\t\tapp1: qldSeries\n\t}\n\n\n\tconst options1 = soefinding.getDefaultBarChartOptions()\n\toptions1.xaxis.categories = locationItems.map(d => d.Name)\n\toptions1.xaxis.title.text = \"Station\"\n\toptions1.yaxis.title.text = \"Mean annual pan evaporation (millimetres)\"\n \toptions1.yaxis.labels.formatter = val => Math.round(val).toLocaleString()\n\toptions1.tooltip.y = { formatter: val => val.toLocaleString() }\n\n\tsoefinding.state.chart1 = {\n\t\toptions: options1,\n\t\tseries: soefinding.findingContent.Queensland.app1,\n\t\tchartactive: true,\n\t}\n\n\n\t// 2. line chart for each region\n\n\tfor (let region in soefinding.regions) {\n\n\t\t// create a data series for this region\n\t\tconst item = soefinding.findingJson.data.filter(d => d.Name == region)\n\t\tconst seriesNames = [\"Actual\", \"Moving average\"]\n\t\tconst series = seriesNames.map(s => {\n\t\t\tconst regionItem = item.find(d => d.Measure == s)\n\t\t\treturn {\n\t\t\t\tname: s,\n\t\t\t\tdata: soefinding.yearKeys.map(y => regionItem[y])\n\t\t\t}\n\t\t})\n\n\t\t// findingContent holds the html and data series for each region\n\t\tsoefinding.findingContent[region] = {\n\t\t\thtml: \"\",\n\t\t\tapp2: series\n\t\t}\n\t}\n\n\n\tconst options2 = soefinding.getDefaultLineChartOptions()\n\toptions2.xaxis.categories = soefinding.yearKeys\n\toptions2.xaxis.title.text = \"Year\"\n\toptions2.yaxis.title.text = \"Annual pan evaporation (millimetres)\"\n\toptions2.yaxis.labels.formatter = val => Math.round(val).toLocaleString()\n\toptions2.tooltip.y = { formatter: val => val?.toLocaleString() ?? \"n/a\" }\n\n\n\tsoefinding.state.chart2 = {\n\t\toptions: options2,\n\t\tseries: null,\n\t\tchartactive: true,\n\t}\n\tif (soefinding.state.currentRegionName == \"Queensland\")\n\t  soefinding.state.chart2.series = soefinding.findingContent[\"Cairns Airport\"].app2 // need a default\n\telse\n      soefinding.state.chart2.series = soefinding.findingContent[soefinding.state.currentRegionName].app2\n\n\tnew Vue({\n\t\tel: \"#chartContainer\",\n\t\tdata: soefinding.state,\n\t\tcomputed: {\n\t\t\theading1: () => `Mean annual pan evaporation, ${soefinding.yearKeys[0]}â€“${latestYear}`,\n\t\t\theading2: () => `Trend in evaporation rate at ${soefinding.state.currentRegionName}`,\n\t\t},\n\t\tmethods: {\n\t\t\tformatter1: function (val) { return val?.toLocaleString(undefined, { minimumFractionDigits: 1, maximumFractionDigits: 1, }) ?? \"\" }\n\t\t}\n\t})\n\n\tif (soefinding.state.currentRegionName == \"Queensland\")\n\t\tsoefinding.onRegionChange()\n\n\n})\n\n\n\nsoefinding.onRegionChange = function () {\n\n\tconst regionInfos = document.querySelectorAll(\"div.region-info\")\n\n\tif (this.state.currentRegionName == \"Queensland\") {\n\t\t// toggle visibility of first region-info, which is for Queensland\n\t\ttry {\n\t\tregionInfos[0].style.display = \"block\"\n\t\tregionInfos[1].style.display = \"none\"\n\t\t} catch(e) {\n\t\t\t// i don't know why there's only one sometimes\n\t\t}\n\t}\n\telse {\n\t\t// toggle visibility of second region-info, which is for the current region\n\t\tregionInfos[0].style.display = \"none\"\n\t\tregionInfos[1].style.display = \"block\"\n\n\t\t// set the data series in each of the vue apps, for the current region\n\t\tthis.state.chart2.series = this.findingContent[this.state.currentRegionName].app2\n\t}\n\n\tsoefinding.loadFindingHtml();\n}\n\n"],"mappings":"aAEA,WAAW,QAAU,aAGrB,SAAS,iBAAiB,mBAAoB,UAAY,CAEzD,WAAW,SAAW,WAAW,YAAY,KAAK,OAAO,MAAM,GAC/D,KAAM,YAAa,WAAW,SAAS,WAAW,SAAS,OAAS,GACpE,KAAM,aAAc,OAAO,KAAK,WAAW,SAK3C,KAAM,eAAgB,WAAW,YAAY,KAAK,OAAO,GAAK,EAAE,SAAW,UAC3E,KAAM,WAAY,CAAC,CAClB,KAAM,UACN,KAAM,cAAc,IAAI,GAAK,CAC5B,GAAI,OAAQ,EACZ,KAAM,KAAM,WAAW,SAAS,OAAO,SAAU,IAAK,KAAM,EAAG,EAAG,CACjE,GAAI,EAAE,MAAO,CACZ,EAAE,MACF,MAAO,KAAM,EAAE,UACT,OAAO,MACZ,GACH,MAAO,KAAM,UAGf,WAAW,eAAe,WAAa,CACtC,KAAM,GACN,KAAM,WAIP,KAAM,UAAW,WAAW,4BAC5B,SAAS,MAAM,WAAa,cAAc,IAAI,GAAK,EAAE,MACrD,SAAS,MAAM,MAAM,KAAO,UAC5B,SAAS,MAAM,MAAM,KAAO,4CAC3B,SAAS,MAAM,OAAO,UAAY,KAAO,KAAK,MAAM,KAAK,iBAC1D,SAAS,QAAQ,EAAI,CAAE,UAAW,KAAO,IAAI,kBAE7C,WAAW,MAAM,OAAS,CACzB,QAAS,SACT,OAAQ,WAAW,eAAe,WAAW,KAC7C,YAAa,MAMd,OAAS,UAAU,YAAW,QAAS,CAGtC,KAAM,MAAO,WAAW,YAAY,KAAK,OAAO,GAAK,EAAE,MAAQ,QAC/D,KAAM,aAAc,CAAC,SAAU,kBAC/B,KAAM,QAAS,YAAY,IAAI,GAAK,CACnC,KAAM,YAAa,KAAK,KAAK,GAAK,EAAE,SAAW,GAC/C,MAAO,CACN,KAAM,EACN,KAAM,WAAW,SAAS,IAAI,GAAK,WAAW,OAKhD,WAAW,eAAe,QAAU,CACnC,KAAM,GACN,KAAM,QAKR,KAAM,UAAW,WAAW,6BAC5B,SAAS,MAAM,WAAa,WAAW,SACvC,SAAS,MAAM,MAAM,KAAO,OAC5B,SAAS,MAAM,MAAM,KAAO,uCAC5B,SAAS,MAAM,OAAO,UAAY,KAAO,KAAK,MAAM,KAAK,iBACzD,SAAS,QAAQ,EAAI,CAAE,UAAW,KAAO,KAAK,kBAAoB,OAGlE,WAAW,MAAM,OAAS,CACzB,QAAS,SACT,OAAQ,KACR,YAAa,MAEd,GAAI,WAAW,MAAM,mBAAqB,aACxC,WAAW,MAAM,OAAO,OAAS,WAAW,eAAe,kBAAkB,SAE1E,YAAW,MAAM,OAAO,OAAS,WAAW,eAAe,WAAW,MAAM,mBAAmB,KAEpG,GAAI,KAAI,CACP,GAAI,kBACJ,KAAM,WAAW,MACjB,SAAU,CACT,SAAU,IAAM,gCAAgC,WAAW,SAAS,WAAM,aAC1E,SAAU,IAAM,gCAAgC,WAAW,MAAM,qBAElE,QAAS,CACR,WAAY,SAAU,IAAK,CAAE,MAAO,MAAK,eAAe,OAAW,CAAE,sBAAuB,EAAG,sBAAuB,KAAS,OAIjI,GAAI,WAAW,MAAM,mBAAqB,aACzC,WAAW,mBAOb,WAAW,eAAiB,UAAY,CAEvC,KAAM,aAAc,SAAS,iBAAiB,mBAE9C,GAAI,KAAK,MAAM,mBAAqB,aAAc,CAEjD,GAAI,CACJ,YAAY,GAAG,MAAM,QAAU,QAC/B,YAAY,GAAG,MAAM,QAAU,aACvB,EAAN,OAIE,CAEJ,YAAY,GAAG,MAAM,QAAU,OAC/B,YAAY,GAAG,MAAM,QAAU,QAG/B,KAAK,MAAM,OAAO,OAAS,KAAK,eAAe,KAAK,MAAM,mBAAmB,KAG9E,WAAW","names":[]}
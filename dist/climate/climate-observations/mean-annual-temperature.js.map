{"version":3,"sources":["../../../src/climate/climate-observations/mean-annual-temperature.js"],"sourcesContent":["\"use strict\"\n\nsoefinding.regions = pinLocations // these should already be set in ssjs\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n\n\tconst yearKeys = soefinding.findingJson.meta.fields.slice(2);\n\tconst latestYear = yearKeys[yearKeys.length - 1]\n\n\t//1. mean temperature anomaly base, qld only\n\tconst qldMeanAnomalyItem = soefinding.findingJson.data.find(d => d.Name == \"Queensland\" && d.Measure == \"Mean anomaly (Base 1961-1990)\")\n\tconst qldMeanAnomalySeries = [{\n\t\tname: \"Temperature anomaly\",\n\t\tdata: yearKeys.map(y => qldMeanAnomalyItem[y])\n\t}]\n\n\tsoefinding.findingContent.Queensland = {\n\t\thtml: \"\",\n\t\tapp1: qldMeanAnomalySeries\n\t}\n\n\tconst options1 = soefinding.getDefaultBarChartOptions();\n\toptions1.xaxis.categories = yearKeys\n\toptions1.xaxis.title.text = \"Year\"\n\toptions1.yaxis.title.text = \"Temperature anomaly (degrees celsius)\";\n\toptions1.tooltip.y = {\n\t\t\tformatter: val => val >= 0 ? val : `-${Math.abs(val)}`\n\t\t}\n\n\tsoefinding.state.chart1 = {\n\t\toptions: options1,\n\t\tseries: soefinding.findingContent.Queensland.app1,\n\t\tchartactive: true,\n\t}\n\n\n\t// 2. line chart qld, actual mean and 10 year moving average\n\tconst qldMeanItem = soefinding.findingJson.data.find(d => d.Name == \"Queensland\" && d.Measure == \"Actual mean\")\n\tconst qldMeanSeries = [{\n\t\tname: \"Actual Mean\",\n\t\tdata: yearKeys.map(y => qldMeanItem[y])\n\t},\n\t{\n\t\tname: \"10-year moving average\",\n\t\tdata: yearKeys.map((y, i) => getTenYearMovingAverage(i))\n\t}]\n\tsoefinding.findingContent.Queensland.app2 = qldMeanSeries\n\n\tfunction getTenYearMovingAverage(index) {\n\t\tif (index < 9)\n\t\t\treturn null\n\t\tconst values = yearKeys.slice(index - 9, index + 1)\n\t\tif (values.every(v => qldMeanItem[v] != null)) {\n\t\t\tconst sum = values.reduce(function (acc, curr) {\n\t\t\t\treturn (acc + qldMeanItem[curr])\n\t\t\t}, 0)\n\t\t\treturn sum / 10.0\n\t\t}\n\t\telse\n\t\t\treturn null\n\t}\n\n\tconst options2 = soefinding.getDefaultLineChartOptions()\n\toptions2.stroke = { width: 1.5 }\n\toptions2.markers.size = 0\n\toptions2.xaxis.categories = yearKeys\n\toptions2.xaxis.title.text = \"Year\"\n\toptions2.yaxis.title.text = \"Temperature (degrees celsius)\"\n\toptions2.yaxis.labels.formatter = val => Math.round(val)\n\toptions2.tooltip.y = { formatter: val => (val == null ? \"n/a\" : val.toFixed(2)) }\n\n\n\tsoefinding.state.chart2 = {\n\t\toptions: options2,\n\t\tseries: soefinding.findingContent.Queensland.app2,\n\t\tchartactive: true,\n\t};\n\n\t// populate for each pin location, the data already has 10 year mean calculated\n\tObject.keys(pinLocations).forEach(function (loc) {\n\t\tconst meanItem = soefinding.findingJson.data.find(d => d.Name == loc && d.Measure == \"Actual mean\")\n\t\tconst tenYearMeanItem = soefinding.findingJson.data.find(d => d.Name == loc && d.Measure == \"Moving average mean\")\n\t\tconst meanSeries = [{\n\t\t\tname: \"Actual Mean\",\n\t\t\tdata: yearKeys.map(y => meanItem[y])\n\t\t},\n\t\t{\n\t\t\tname: \"10-year moving average\",\n\t\t\tdata: yearKeys.map(y => tenYearMeanItem[y])\n\t\t}]\n\t\tsoefinding.findingContent[loc] = {\n\t\t\thtml: \"\",\n\t\t\tapp2: meanSeries\n\t\t}\n\n\t})\n\n\n\tnew Vue({\n\t\tel: \"#chartContainer\",\n\t\tdata: soefinding.state,\n\t\tcomputed: {\n\t\t\theading1: () => `Annual mean temperature anomaly, base ${yearKeys[0]}â€“${latestYear}`,\n\t\t\theading2: () => `Trend in annual mean temperature, ${soefinding.state.currentRegionName}`,\n\t\t},\n\t\tmethods: {\n\t\t\tformatter1: val => val >= 0 ? val.toFixed(2) : `-${Math.abs(val).toFixed(2)}`,\n\t\t\tformatter2: val => val?.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) ?? \"\"\n\n\t\t}\n\t})\n\n})\n\n\n\nsoefinding.onRegionChange = function () {\n\n\tconst regionInfos = document.querySelectorAll(\"div.region-info\")\n\n\tif (this.state.currentRegionName == \"Queensland\") {\n\t\t// toggle visibility of first region-info, which is for Queensland\n\t\tregionInfos[0].style.display = \"block\"\n\t}\n\telse {\n\t\t// toggle visibility of second region-info, which is for the current region\n\t\tregionInfos[0].style.display = \"none\"\n\n\t\t// set the data series in each of the vue apps, for the current region\n\t\tthis.state.chart2.series = this.findingContent[this.state.currentRegionName].app2;\n\t}\n\n\tsoefinding.loadFindingHtml()\n}\n\n"],"mappings":"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","names":[]}
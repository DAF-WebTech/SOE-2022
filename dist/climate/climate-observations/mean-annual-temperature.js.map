{"version":3,"sources":["../../../src/climate/climate-observations/mean-annual-temperature.js"],"sourcesContent":["\"use strict\"\n\nsoefinding.regions = pinLocations // these should already be set in ssjs\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n\n\tconst yearKeys = soefinding.findingJson.meta.fields.slice(2);\n\tconst latestYear = yearKeys[yearKeys.length - 1]\n\n\t//1. mean temperature anomaly base, qld only\n\tconst qldMeanAnomalyItem = soefinding.findingJson.data.find(d => d.Name == \"Queensland\" && d.Measure == \"Mean anomaly (Base 1961-1990)\")\n\tconst qldMeanAnomalySeries = [{\n\t\tname: \"Temperature anomaly\",\n\t\tdata: yearKeys.map(y => qldMeanAnomalyItem[y])\n\t}]\n\n\tsoefinding.findingContent.Queensland = {\n\t\thtml: \"\",\n\t\tapp1: qldMeanAnomalySeries\n\t}\n\n\tconst options1 = soefinding.getDefaultBarChartOptions();\n\toptions1.xaxis.categories = yearKeys\n\toptions1.xaxis.title.text = \"Year\"\n\toptions1.yaxis.title.text = \"Temperature anomaly (degrees celsius)\";\n\toptions1.tooltip.y = {\n\t\t\tformatter: val => val >= 0 ? val : `-${Math.abs(val)}`\n\t\t}\n\n\tsoefinding.state.chart1 = {\n\t\toptions: options1,\n\t\tseries: soefinding.findingContent.Queensland.app1,\n\t\tchartactive: true,\n\t}\n\n\n\t// 2. line chart qld, actual mean and 10 year moving average\n\tconst qldMeanItem = soefinding.findingJson.data.find(d => d.Name == \"Queensland\" && d.Measure == \"Actual mean\")\n\tconst qldMeanSeries = [{\n\t\tname: \"Actual Mean\",\n\t\tdata: yearKeys.map(y => qldMeanItem[y])\n\t},\n\t{\n\t\tname: \"10-year moving average\",\n\t\tdata: yearKeys.map((y, i) => getTenYearMovingAverage(i))\n\t}]\n\tsoefinding.findingContent.Queensland.app2 = qldMeanSeries\n\n\tfunction getTenYearMovingAverage(index) {\n\t\tif (index < 9)\n\t\t\treturn null\n\t\tconst values = yearKeys.slice(index - 9, index + 1)\n\t\tif (values.every(v => qldMeanItem[v] != null)) {\n\t\t\tconst sum = values.reduce(function (acc, curr) {\n\t\t\t\treturn (acc + qldMeanItem[curr])\n\t\t\t}, 0)\n\t\t\treturn sum / 10.0\n\t\t}\n\t\telse\n\t\t\treturn null\n\t}\n\n\tconst options2 = soefinding.getDefaultLineChartOptions()\n\toptions2.stroke = { width: 1.5 }\n\toptions2.markers.size = 0\n\toptions2.xaxis.categories = yearKeys\n\toptions2.xaxis.title.text = \"Year\"\n\toptions2.yaxis.title.text = \"Temperature (degrees celsius)\"\n\toptions2.yaxis.labels.formatter = val => Math.round(val)\n\toptions2.tooltip.y = { formatter: val => (val == null ? \"n/a\" : val.toFixed(2)) }\n\n\n\tsoefinding.state.chart2 = {\n\t\toptions: options2,\n\t\tseries: soefinding.findingContent.Queensland.app2,\n\t\tchartactive: true,\n\t};\n\n\t// populate for each pin location, the data already has 10 year mean calculated\n\tObject.keys(pinLocations).forEach(function (loc) {\n\t\tconst meanItem = soefinding.findingJson.data.find(d => d.Name == loc && d.Measure == \"Actual mean\")\n\t\tconst tenYearMeanItem = soefinding.findingJson.data.find(d => d.Name == loc && d.Measure == \"Moving average mean\")\n\t\tconst meanSeries = [{\n\t\t\tname: \"Actual Mean\",\n\t\t\tdata: yearKeys.map(y => meanItem[y])\n\t\t},\n\t\t{\n\t\t\tname: \"10-year moving average\",\n\t\t\tdata: yearKeys.map(y => tenYearMeanItem[y])\n\t\t}]\n\t\tsoefinding.findingContent[loc] = {\n\t\t\thtml: \"\",\n\t\t\tapp2: meanSeries\n\t\t}\n\n\t})\n\n\n\tnew Vue({\n\t\tel: \"#chartContainer\",\n\t\tdata: soefinding.state,\n\t\tcomputed: {\n\t\t\theading1: () => `Annual mean temperature anomaly, base ${yearKeys[0]}â€“${latestYear}`,\n\t\t\theading2: () => `Trend in annual mean temperature, ${soefinding.state.currentRegionName}`,\n\t\t},\n\t\tmethods: {\n\t\t\tformatter1: val => val >= 0 ? val.toFixed(2) : `-${Math.abs(val).toFixed(2)}`,\n\t\t\tformatter2: val => val?.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) ?? \"\"\n\n\t\t}\n\t})\n\n})\n\n\n\nsoefinding.onRegionChange = function () {\n\n\tconst regionInfos = document.querySelectorAll(\"div.region-info\")\n\n\tif (this.state.currentRegionName == \"Queensland\") {\n\t\t// toggle visibility of first region-info, which is for Queensland\n\t\tregionInfos[0].style.display = \"block\"\n\t}\n\telse {\n\t\t// toggle visibility of second region-info, which is for the current region\n\t\tregionInfos[0].style.display = \"none\"\n\n\t\t// set the data series in each of the vue apps, for the current region\n\t\tthis.state.chart2.series = this.findingContent[this.state.currentRegionName].app2;\n\t}\n\n\tsoefinding.loadFindingHtml()\n}\n\n"],"mappings":"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","names":[]}
{"version":3,"sources":["../../../src/heritage/aboriginal-torres-strait/site-locations.js"],"sourcesContent":["\"use strict\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n\r\n\tconst years = soefinding.findingJson.meta.fields.slice(2)\r\n\tconst latestYear = years.at(-1)\r\n\r\n\tconst regions = new Map()\r\n\tconst sites = new Map()\r\n\tsoefinding.regionNames.forEach(r => regions.set(r, []))\r\n\tsoefinding.findingJson.data.forEach(d => {\r\n\t\tregions.get(d.Region).push(d)\r\n\r\n\t\t// sites are to populate qld item\r\n\t\tif (!sites.has(d.Site))\r\n\t\t\tsites.set(d.Site, [])\r\n\t\tsites.get(d.Site).push(d)\r\n\t})\r\n\r\n\t// add each \"Site\" up for our qld aggregate item\r\n\tregions.set(\"Queensland\", [])\r\n\tfor (let [site, data] of sites) {\r\n\t\tconst newItem = {\r\n\t\t\tRegion: \"Queensland\",\r\n\t\t\tSite: site,\r\n\t\t}\r\n\t\tyears.forEach(y => newItem[y] = data.reduce((acc, curr) => {\r\n \t\t\treturn acc + curr[y]\r\n \t\t}, 0))\r\n\r\n\t\r\n\t\tregions.get(\"Queensland\").push(newItem)\r\n\t}\r\n\r\n\t// chart 1 stacked column\r\n\tfor (let [region, data] of regions) {\r\n\t\tdata.sort(function(a, b) {\r\n\t\t\treturn b[latestYear] - a[latestYear]\r\n\t\t})\r\n\t\tsoefinding.findingContent[region] = { \r\n\t\t\tseries1: data.map(d => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tname: d.Site,\r\n\t\t\t\t\tdata: years.map(y => d[y])\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tseries2: data.map(d => d[latestYear] ?? 0),\r\n\t\t\tseries2Labels: data.map(d => d.Site)\r\n\t\t}\r\n\t}\r\n\r\n\tconst options1 = soefinding.getDefaultStackedColumnChartOptions()\r\n\toptions1.xaxis.title.text = \"Year\"\r\n\toptions1.xaxis.categories = years\r\n\toptions1.yaxis.title.text = \"Number of places\"\r\n\toptions1.yaxis.labels.formatter = val => val.toLocaleString()\r\n\toptions1.yaxis.forceNiceScale = false\r\n\r\n\tsoefinding.state.chart1 = {\r\n\t\tseries: soefinding.findingContent[soefinding.state.currentRegionName].series1,\r\n\t\toptions: options1,\r\n\t\tchartactive: true,\r\n\t}\r\n\r\n\r\n\tconst options2 = soefinding.getDefaultPieChartOptions()\r\n\toptions2.labels = soefinding.findingContent[soefinding.state.currentRegionName].series2Labels\r\n\toptions2.tooltip.y = { \r\n\t\tformatter: (val, options) => {\r\n\t\t\tconst percent = options.globals.seriesPercent[options.seriesIndex][0]\r\n\t\t\treturn `${val.toLocaleString()} ha (${percent.toFixed(1)}%)`\r\n\t\t}\r\n\t}\r\n\toptions2.xaxis.categories = [\"Site\", \"Number of locations\"]\r\n\r\n\r\n\tsoefinding.state.chart2 = {\r\n\t\tseries: soefinding.findingContent[soefinding.state.currentRegionName].series2,\r\n\t\toptions: options2,\r\n\t\tchartactive: true,\r\n\t}\r\n\r\n\r\n\r\n\tnew Vue({\r\n\t\tel: \"#chartContainer\",\r\n\t\tdata: soefinding.state,\r\n\t\tcomputed: {\r\n\t\t\theading1: function () {\r\n\t\t\t\tif (this.currentRegionName == \"Queensland\")\r\n\t\t\t\t\treturn \"Change in number of locations, by site type\"\r\n\t\t\t\telse \r\n\t\t\t\t\treturn `Change in number of locations by site type in ${this.currentRegionName} cultural heritage region`\r\n\t\t\t},\r\n\t\t\theading2: function () {\r\n\t\t\t\tif (this.currentRegionName == \"Queensland\")\r\n\t\t\t\t\treturn `Proportion of locations by site type, ${latestYear}`\r\n\t\t\t\telse \r\n\t\t\t\t\treturn `Proportion of locations by site type in ${this.currentRegionName} cultural heritage region, ${latestYear}`\r\n\t\t\t},\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tformatter1: val => val?.toLocaleString() ?? \"\"\r\n\t\t}\r\n\t})\r\n\r\n\r\n\twindow.soefinding.onRegionChange = function () {\r\n\t\tsoefinding.state.chart1.series = soefinding.findingContent[soefinding.state.currentRegionName].series1\r\n\t\t\r\n\t\tsoefinding.state.chart2.options.labels = soefinding.findingContent[soefinding.state.currentRegionName].series2Labels\r\n\t\tsoefinding.state.chart2.series = soefinding.findingContent[soefinding.state.currentRegionName].series2\r\n\r\n\t\tsoefinding.loadFindingHtml()\r\n\t}\r\n\r\n})"],"mappings":"aAEA,SAAS,iBAAiB,mBAAoB,UAAY,CAEzD,KAAM,OAAQ,WAAW,YAAY,KAAK,OAAO,MAAM,GACvD,KAAM,YAAa,MAAM,GAAG,IAE5B,KAAM,SAAU,GAAI,KACpB,KAAM,OAAQ,GAAI,KAClB,WAAW,YAAY,QAAQ,GAAK,QAAQ,IAAI,EAAG,KACnD,WAAW,YAAY,KAAK,QAAQ,GAAK,CACxC,QAAQ,IAAI,EAAE,QAAQ,KAAK,GAG3B,GAAI,CAAC,MAAM,IAAI,EAAE,MAChB,MAAM,IAAI,EAAE,KAAM,IACnB,MAAM,IAAI,EAAE,MAAM,KAAK,KAIxB,QAAQ,IAAI,aAAc,IAC1B,OAAS,CAAC,KAAM,OAAS,OAAO,CAC/B,KAAM,SAAU,CACf,OAAQ,aACR,KAAM,MAEP,MAAM,QAAQ,GAAK,QAAQ,GAAK,KAAK,OAAO,CAAC,IAAK,OAAS,CACzD,MAAO,KAAM,KAAK,IAChB,IAGJ,QAAQ,IAAI,cAAc,KAAK,SAIhC,OAAS,CAAC,OAAQ,OAAS,SAAS,CACnC,KAAK,KAAK,SAAS,EAAG,EAAG,CACxB,MAAO,GAAE,YAAc,EAAE,cAE1B,WAAW,eAAe,QAAU,CACnC,QAAS,KAAK,IAAI,GAAK,CACtB,MAAO,CACN,KAAM,EAAE,KACR,KAAM,MAAM,IAAI,GAAK,EAAE,OAGzB,QAAS,KAAK,IAAI,GAAK,EAAE,aAAe,GACxC,cAAe,KAAK,IAAI,GAAK,EAAE,OAIjC,KAAM,UAAW,WAAW,sCAC5B,SAAS,MAAM,MAAM,KAAO,OAC5B,SAAS,MAAM,WAAa,MAC5B,SAAS,MAAM,MAAM,KAAO,mBAC5B,SAAS,MAAM,OAAO,UAAY,KAAO,IAAI,iBAC7C,SAAS,MAAM,eAAiB,MAEhC,WAAW,MAAM,OAAS,CACzB,OAAQ,WAAW,eAAe,WAAW,MAAM,mBAAmB,QACtE,QAAS,SACT,YAAa,MAId,KAAM,UAAW,WAAW,4BAC5B,SAAS,OAAS,WAAW,eAAe,WAAW,MAAM,mBAAmB,cAChF,SAAS,QAAQ,EAAI,CACpB,UAAW,CAAC,IAAK,UAAY,CAC5B,KAAM,SAAU,QAAQ,QAAQ,cAAc,QAAQ,aAAa,GACnE,MAAO,GAAG,IAAI,wBAAwB,QAAQ,QAAQ,SAGxD,SAAS,MAAM,WAAa,CAAC,OAAQ,uBAGrC,WAAW,MAAM,OAAS,CACzB,OAAQ,WAAW,eAAe,WAAW,MAAM,mBAAmB,QACtE,QAAS,SACT,YAAa,MAKd,GAAI,KAAI,CACP,GAAI,kBACJ,KAAM,WAAW,MACjB,SAAU,CACT,SAAU,UAAY,CACrB,GAAI,KAAK,mBAAqB,aAC7B,MAAO,kDAEP,OAAO,iDAAiD,KAAK,8CAE/D,SAAU,UAAY,CACrB,GAAI,KAAK,mBAAqB,aAC7B,MAAO,yCAAyC,iBAEhD,OAAO,2CAA2C,KAAK,+CAA+C,eAGzG,QAAS,CACR,WAAY,KAAO,KAAK,kBAAoB,MAK9C,OAAO,WAAW,eAAiB,UAAY,CAC9C,WAAW,MAAM,OAAO,OAAS,WAAW,eAAe,WAAW,MAAM,mBAAmB,QAE/F,WAAW,MAAM,OAAO,QAAQ,OAAS,WAAW,eAAe,WAAW,MAAM,mBAAmB,cACvG,WAAW,MAAM,OAAO,OAAS,WAAW,eAAe,WAAW,MAAM,mBAAmB,QAE/F,WAAW","names":[]}